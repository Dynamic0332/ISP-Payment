<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>ISP Payment Tracker – Offline</title>
  <style>
    body {margin:0;font-family:Arial,sans-serif;background:#f0f2f5;color:#333;}
    header {background:#003366;color:#fff;padding:1rem;text-align:center;position:relative;}
    #logoutBtn {position:absolute;right:1rem;top:50%;transform:translateY(-50%);background:#e60000;color:#fff;border:none;padding:0.4rem 0.8rem;border-radius:4px;cursor:pointer;}
    main {max-width:1000px;margin:auto;padding:1rem;}
    .cards {display:flex;gap:1rem;flex-wrap:wrap;margin-bottom:1rem;}
    .card {flex:1;background:#fff;padding:1rem;border-radius:8px;box-shadow:0 0 10px rgba(0,0,0,0.05);text-align:center;}
    .card h3 {margin:0;font-size:1rem;color:#003366;}
    .card span {font-size:1.5rem;font-weight:bold;display:block;}
    .section-box {background:#fff;padding:1rem;border-radius:8px;box-shadow:0 0 10px rgba(0,0,0,0.05);margin-bottom:1rem;}
    input, select, button {width:100%;max-width:400px;padding:0.5rem;margin:0.5rem 0;border:1px solid #ccc;border-radius:5px;}
    button {background:#003366;color:#fff;border:none;cursor:pointer;}
    button:hover {opacity:0.9;}
    table {width:100%;border-collapse:collapse;margin-top:1rem;}
    th, td {padding:0.5rem;border:1px solid #ccc;text-align:left;}
    th {background:#003366;color:#fff;}
    .paid {color:green;font-weight:bold;}
    .unpaid {color:red;font-weight:bold;}
    #login-section {max-width:400px;margin:50px auto;background:#fff;padding:2rem;border-radius:8px;box-shadow:0 0 10px rgba(0,0,0,0.1);}
    #login-section h2 {margin-top:0;text-align:center;color:#003366;}
  </style>
</head>
<body>
  <div id="login-section">
    <h2>Login to ISP Dashboard</h2>
    <input type="text" id="username" placeholder="Username" />
    <input type="password" id="password" placeholder="Password" />
    <button onclick="login()">Login</button>
    <p id="login-error" style="color:red;"></p>
  </div>

  <main id="dashboard" style="display:none;">
    <header>
      <h1>Dynamic Internet Service – Payment Tracker</h1>
      <button id="logoutBtn" onclick="logout()">Logout</button>
    </header>

    <div class="cards">
      <div class="card"><h3>Total Users</h3><span id="totalUsers">0</span></div>
      <div class="card"><h3>Paid</h3><span id="paidUsers">0</span></div>
      <div class="card"><h3>Unpaid</h3><span id="unpaidUsers">0</span></div>
    </div>

    <div class="section-box">
      <h2>Add User</h2>
      <input type="text" id="name" placeholder="Name" />
      <input type="text" id="phone" placeholder="Phone Number" />
      <input type="text" id="address" placeholder="Address" />
      <select id="package">
        <option value="15Mbps">15 Mbps</option>
        <option value="16Mbps Static IP">16 Mbps Static IP</option>
        <option value="20Mbps">20 Mbps</option>
        <option value="30Mbps">30 Mbps</option>
        <option value="32Mbps Static IP">32 Mbps Static IP</option>
        <option value="40Mbps">40 Mbps</option>
        <option value="50Mbps">50 Mbps</option>
        <option value="60Mbps">60 Mbps</option>
        <option value="75Mbps">75 Mbps</option>
      </select>
      <input type="number" id="amount" placeholder="Monthly Amount" />
      <button onclick="addUser()">Add User</button>
    </div>

    <div class="section-box">
      <h2>User List</h2>
      <table>
        <thead>
          <tr>
            <th>Name</th>
            <th>Phone</th>
            <th>Address</th>
            <th>Package</th>
            <th>Amount</th>
            <th>Status</th>
            <th>Actions</th>
          </tr>
        </thead>
        <tbody id="userTable"></tbody>
      </table>
    </div>
  </main>

  <script>
    const users = JSON.parse(localStorage.getItem('users')) || [];

    function login() {
      const u = document.getElementById('username').value.trim().toLowerCase();
      const p = document.getElementById('password').value.trim().toLowerCase();
      if (u === 'dynamic' && p === 'dynamic') {
        localStorage.setItem('loggedIn', 'true');
        showDashboard();
      } else {
        document.getElementById('login-error').innerText = 'Invalid username or password';
      }
    }

    function logout() {
      localStorage.removeItem('loggedIn');
      document.getElementById('dashboard').style.display = 'none';
      document.getElementById('login-section').style.display = 'block';
    }

    function showDashboard() {
      document.getElementById('login-section').style.display = 'none';
      document.getElementById('dashboard').style.display = 'block';
      loadUsers();
    }

    function addUser() {
      const name = document.getElementById('name').value;
      const phone = document.getElementById('phone').value;
      const address = document.getElementById('address').value;
      const pkg = document.getElementById('package').value;
      const amount = document.getElementById('amount').value;

      if (!name || !phone || !address || !pkg || !amount) {
        alert('Please fill all fields');
        return;
      }

      users.push({ id: Date.now(), name, phone, address, pkg, amount, paid: false });
      localStorage.setItem('users', JSON.stringify(users));
      loadUsers();
      ['name', 'phone', 'address', 'amount'].forEach(id => document.getElementById(id).value = '');
    }

    function deleteUser(id) {
      const index = users.findIndex(u => u.id === id);
      if (index !== -1) {
        users.splice(index, 1);
        localStorage.setItem('users', JSON.stringify(users));
        loadUsers();
      }
    }

    function toggleStatus(id) {
      const user = users.find(u => u.id === id);
      if (user) {
        user.paid = !user.paid;
        localStorage.setItem('users', JSON.stringify(users));
        loadUsers();
      }
    }

    function sendReminder(phone, pkg, amount) {
      const message = `Dear customer, your monthly internet bill of Rs.${amount} for ${pkg} is due. Kindly pay to avoid disconnection.%0A%0ARegards, Dynamic Internet Service`;
      const url = `https://wa.me/${phone}?text=${message}`;
      window.open(url, '_blank');
    }

    function loadUsers() {
      const table = document.getElementById('userTable');
      table.innerHTML = '';
      let paid = 0;
      users.forEach(user => {
        if (user.paid) paid++;
        const row = `<tr>
          <td>${user.name}</td>
          <td>${user.phone}</td>
          <td>${user.address}</td>
          <td>${user.pkg}</td>
          <td>${user.amount}</td>
          <td class="${user.paid ? 'paid' : 'unpaid'}">${user.paid ? 'Paid' : 'Unpaid'}</td>
          <td>
            <button onclick="toggleStatus(${user.id})">Toggle</button>
            <button onclick="deleteUser(${user.id})">Delete</button>
            <button onclick="sendReminder('${user.phone}', '${user.pkg}', '${user.amount}')">Reminder</button>
          </td>
        </tr>`;
        table.innerHTML += row;
      });
      document.getElementById('totalUsers').innerText = users.length;
      document.getElementById('paidUsers').innerText = paid;
      document.getElementById('unpaidUsers').innerText = users.length - paid;
    }

    document.addEventListener("DOMContentLoaded", () => {
      if (localStorage.getItem("loggedIn") === "true") {
        showDashboard();
      }
    });
  </script>
</body>
</html>
